<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:f="http://xmlns.jcp.org/jsf/core">

<f:metadata>
   <f:viewParam name="id" value="#{deleteRingBean.ringId}"/>
   <f:event type="preRenderView" listener="#{deleteRingBean.loadRing}"/>
</f:metadata>

<h:head>
   <title>–£–¥–∞–ª–µ–Ω–∏–µ –∫–æ–ª—å—Ü–∞</title>
   <style type="text/css">
      .container { max-width: 600px; margin: 0 auto; padding: 20px; }
      .warning-box { border: 2px solid #dc3545; background: #f8d7da; padding: 20px; border-radius: 5px; margin: 20px 0; }
      .details-table { width: 100%; border-collapse: collapse; margin: 20px 0; }
      .details-table th, .details-table td { border: 1px solid #ddd; padding: 8px; text-align: left; }
      .btn { padding: 10px 20px; margin: 5px; border: none; border-radius: 4px; cursor: pointer; }
      .btn-danger { background: #dc3545; color: white; }
      .btn-secondary { background: #6c757d; color: white; }
      .dialog-overlay {
         position: fixed; top: 0; left: 0; width: 100%; height: 100%;
         background: rgba(0,0,0,0.5); display: flex; justify-content: center;
         align-items: center; z-index: 1000;
      }
      .dialog-content {
         background: white; padding: 25px; border-radius: 8px;
         min-width: 500px; max-width: 80%; box-shadow: 0 4px 6px rgba(0,0,0,0.1);
      }
   </style>
</h:head>

<h:body>
   <div class="container">
      <h1>üóëÔ∏è –£–¥–∞–ª–µ–Ω–∏–µ –∫–æ–ª—å—Ü–∞</h1>

      <div style="margin-bottom: 20px;">
         <h:link outcome="rings" value="‚Üê –ù–∞–∑–∞–¥ –∫ —Å–ø–∏—Å–∫—É" styleClass="btn btn-secondary"/>
      </div>

      <h:messages/>

      <!-- –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–æ–ª—å—Ü–µ -->
      <ui:fragment rendered="#{deleteRingBean.ring != null}">
         <div class="warning-box">
            <h3>‚ö†Ô∏è –í–Ω–∏–º–∞–Ω–∏–µ!</h3>
            <p>–í—ã —Å–æ–±–∏—Ä–∞–µ—Ç–µ—Å—å —É–¥–∞–ª–∏—Ç—å –∫–æ–ª—å—Ü–æ. –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å.</p>
         </div>

         <h3>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–æ–ª—å—Ü–µ:</h3>
         <table class="details-table">
            <tr>
               <th>ID</th>
               <td>#{deleteRingBean.ring.id}</td>
            </tr>
            <tr>
               <th>–ù–∞–∑–≤–∞–Ω–∏–µ</th>
               <td>#{deleteRingBean.ring.name}</td>
            </tr>
            <tr>
               <th>–°–∏–ª–∞</th>
               <td>#{deleteRingBean.ring.power != null ? deleteRingBean.ring.power : '–ù–µ —É–∫–∞–∑–∞–Ω–∞'}</td>
            </tr>
            <tr>
               <th>–í–µ—Å</th>
               <td>#{deleteRingBean.ring.weight}</td>
            </tr>
         </table>

         <!-- –ö–Ω–æ–ø–∫–∞ –¥–ª—è –∏–Ω–∏—Ü–∏–∞—Ü–∏–∏ —É–¥–∞–ª–µ–Ω–∏—è (–∞–Ω–∞–ª–∏–∑–∞ —Å–≤—è–∑–µ–π) -->
         <h:form>
            <h:commandButton value="‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å —É–¥–∞–ª–µ–Ω–∏–µ"
                             action="#{deleteRingBean.initiateDeletion}"
                             styleClass="btn btn-danger"/>

            <h:link outcome="view-ring" value="‚ùå –û—Ç–º–µ–Ω–∞" styleClass="btn btn-secondary">
               <f:param name="id" value="#{deleteRingBean.ring.id}"/>
            </h:link>
         </h:form>
      </ui:fragment>

      <!-- –°–æ–æ–±—â–µ–Ω–∏–µ –µ—Å–ª–∏ –∫–æ–ª—å—Ü–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ -->
      <ui:fragment rendered="#{deleteRingBean.ring == null}">
         <p style="color: red;">–ö–æ–ª—å—Ü–æ —Å ID #{deleteRingBean.ringId} –Ω–µ –Ω–∞–π–¥–µ–Ω–æ.</p>
         <h:link outcome="rings" value="–í–µ—Ä–Ω—É—Ç—å—Å—è –∫ —Å–ø–∏—Å–∫—É –∫–æ–ª–µ—Ü" styleClass="btn btn-secondary"/>
      </ui:fragment>
   </div>

   <!-- –î–∏–∞–ª–æ–≥ –ø–µ—Ä–µ–ø—Ä–∏–≤—è–∑–∫–∏ (–ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è –ø–µ—Ä–µ–ø—Ä–∏–≤—è–∑–∫–∞) -->
   <ui:fragment rendered="#{deleteRingBean.showDeleteDialog}">
      <div class="dialog-overlay">
         <div class="dialog-content">
            <h2>üîÑ –ü–µ—Ä–µ–ø—Ä–∏–≤—è–∑–∫–∞ –∫–æ–ª—å—Ü–∞</h2>

            <p>–ö–æ–ª—å—Ü–æ <strong>#{deleteRingBean.ring.name} #{deleteRingBean.ring.id}</strong> –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å—É—â–µ—Å—Ç–≤–æ–º:
               <strong>#{deleteRingBean.deletionAnalysis.currentOwner.name} #{deleteRingBean.deletionAnalysis.currentOwner.id}</strong></p>

            <p>–í—ã–±–µ—Ä–∏—Ç–µ –Ω–æ–≤–æ–µ –∫–æ–ª—å—Ü–æ –¥–ª—è —ç—Ç–æ–≥–æ —Å—É—â–µ—Å—Ç–≤–∞:</p>

            <h:form id="reassignmentForm">
               <div style="margin: 20px 0;">
                  <h:selectOneMenu value="#{deleteRingBean.selectedNewRingId}"
                                   style="width: 100%; padding: 8px; margin-bottom: 15px;">
                     <f:selectItem itemLabel="-- –û—Å—Ç–∞–≤–∏—Ç—å –±–µ–∑ –∫–æ–ª—å—Ü–∞ --" itemValue=""/>
                     <f:selectItems value="#{deleteRingBean.deletionAnalysis.availableRings}"
                                    var="freeRing"
                                    itemLabel="#{freeRing.name} (ID: #{freeRing.id})"
                                    itemValue="#{freeRing.id}"/>
                  </h:selectOneMenu>
               </div>

               <div style="margin-top: 20px;">
                  <h:commandButton value="‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å —É–¥–∞–ª–µ–Ω–∏–µ —Å –ø–µ—Ä–µ–ø—Ä–∏–≤—è–∑–∫–æ–π"
                                   action="#{deleteRingBean.performDeletion}"
                                   styleClass="btn btn-danger"/>

                  <h:commandButton value="‚ùå –û—Ç–º–µ–Ω–∞"
                                   action="#{deleteRingBean.cancelDeletion}"
                                   styleClass="btn btn-secondary"/>
               </div>
            </h:form>
         </div>
      </div>
   </ui:fragment>
</h:body>
</html>