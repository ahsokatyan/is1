<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:f="http://xmlns.jcp.org/jsf/core">

<f:metadata>
    <f:viewParam name="id" value="#{deleteCreatureBean.creatureId}"/>
    <f:event type="preRenderView" listener="#{deleteCreatureBean.loadCreature}"/>
</f:metadata>

<h:head>
    <title>–£–¥–∞–ª–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤–∞</title>
    <style type="text/css">
        .container { max-width: 600px; margin: 0 auto; padding: 20px; }
        .warning-box { border: 2px solid #dc3545; background: #f8d7da; padding: 20px; border-radius: 5px; margin: 20px 0; }
        .details-table { width: 100%; border-collapse: collapse; margin: 20px 0; }
        .details-table th, .details-table td { border: 1px solid #ddd; padding: 8px; text-align: left; }
        .btn { padding: 10px 20px; margin: 5px; border: none; border-radius: 4px; cursor: pointer; }
        .btn-danger { background: #dc3545; color: white; }
        .btn-secondary { background: #6c757d; color: white; }
        .dialog-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); display: flex; justify-content: center; align-items: center; z-index: 1000; }
        .dialog-content { background: white; padding: 25px; border-radius: 8px; min-width: 500px; max-width: 80%; }
    </style>
</h:head>

<h:body>
    <div class="container">
        <h1>üóëÔ∏è –£–¥–∞–ª–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤–∞</h1>

        <div style="margin-bottom: 20px;">
            <h:link outcome="creatures" value="‚Üê –ù–∞–∑–∞–¥ –∫ —Å–ø–∏—Å–∫—É" styleClass="btn btn-secondary"/>
        </div>

        <h:messages/>

        <ui:fragment rendered="#{deleteCreatureBean.creature != null}">
            <div class="warning-box">
                <h3>‚ö†Ô∏è –í–Ω–∏–º–∞–Ω–∏–µ!</h3>
                <p>–í—ã —Å–æ–±–∏—Ä–∞–µ—Ç–µ—Å—å —É–¥–∞–ª–∏—Ç—å —Å—É—â–µ—Å—Ç–≤–æ. –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å.</p>
            </div>

            <h3>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å—É—â–µ—Å—Ç–≤–µ:</h3>
            <table class="details-table">
                <tr>
                    <th>ID</th>
                    <td>#{deleteCreatureBean.creature.id}</td>
                </tr>
                <tr>
                    <th>–ò–º—è</th>
                    <td>#{deleteCreatureBean.creature.name}</td>
                </tr>
                <tr>
                    <th>–¢–∏–ø</th>
                    <td>#{deleteCreatureBean.creature.creatureType}</td>
                </tr>
                <tr>
                    <th>–í–æ–∑—Ä–∞—Å—Ç</th>
                    <td>#{deleteCreatureBean.creature.age}</td>
                </tr>
                <tr>
                    <th>–ö–æ–ª—å—Ü–æ</th>
                    <td>#{deleteCreatureBean.creature.ring != null ? deleteCreatureBean.creature.ring.name : '–ù–µ—Ç'}</td>
                </tr>
            </table>

            <h:form>
                <h:commandButton value="‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å —É–¥–∞–ª–µ–Ω–∏–µ"
                                 action="#{deleteCreatureBean.initiateDeletion}"
                                 styleClass="btn btn-danger"/>

                <h:link outcome="view-creature" value="‚ùå –û—Ç–º–µ–Ω–∞" styleClass="btn btn-secondary">
                    <f:param name="id" value="#{deleteCreatureBean.creature.id}"/>
                </h:link>
            </h:form>
        </ui:fragment>

        <ui:fragment rendered="#{deleteCreatureBean.creature == null}">
            <p style="color: red;">–°—É—â–µ—Å—Ç–≤–æ —Å ID #{deleteCreatureBean.creatureId} –Ω–µ –Ω–∞–π–¥–µ–Ω–æ.</p>
        </ui:fragment>
    </div>

    <!-- –î–∏–∞–ª–æ–≥ –ø–µ—Ä–µ–ø—Ä–∏–≤—è–∑–∫–∏ –∫–æ–ª—å—Ü–∞ -->
    <h:form id="reassignmentDialogForm" rendered="#{deleteCreatureBean.showDeleteDialog}">
        <div class="dialog-overlay">
            <div class="dialog-content">
                <h2>üîÑ –ü–µ—Ä–µ–ø—Ä–∏–≤—è–∑–∫–∞ –∫–æ–ª—å—Ü–∞</h2>

                <p>–°—É—â–µ—Å—Ç–≤–æ <strong>#{deleteCreatureBean.creature.name} (ID: #{deleteCreatureBean.creature.id})</strong> –∏–º–µ–µ—Ç –∫–æ–ª—å—Ü–æ:
                    <strong>#{deleteCreatureBean.deletionAnalysis.orphanedRing.name} (ID: #{deleteCreatureBean.deletionAnalysis.orphanedRing.id})</strong></p>

                <p>–í—ã–±–µ—Ä–∏—Ç–µ –Ω–æ–≤–æ–µ —Å—É—â–µ—Å—Ç–≤–æ –¥–ª—è —ç—Ç–æ–≥–æ –∫–æ–ª—å—Ü–∞:</p>

                <div style="margin: 20px 0;">
                    <h:selectOneMenu value="#{deleteCreatureBean.selectedNewRingOwnerId}" style="width: 100%; padding: 8px;">
                        <f:selectItem itemLabel="-- –û—Å—Ç–∞–≤–∏—Ç—å –∫–æ–ª—å—Ü–æ –±–µ–∑ –≤–ª–∞–¥–µ–ª—å—Ü–∞ --" itemValue=""/>
                        <f:selectItems value="#{deleteCreatureBean.deletionAnalysis.availableCreaturesForRing}"
                                       var="creature"
                                       itemLabel="#{creature.name} (ID: #{creature.id})"
                                       itemValue="#{creature.id}"/>
                    </h:selectOneMenu>
                </div>

                <div style="margin-top: 20px;">
                    <h:commandButton value="‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å —É–¥–∞–ª–µ–Ω–∏–µ —Å –ø–µ—Ä–µ–ø—Ä–∏–≤—è–∑–∫–æ–π"
                                     action="#{deleteCreatureBean.performDeletion}"
                                     styleClass="btn btn-danger"/>

                    <h:commandButton value="‚ùå –û—Ç–º–µ–Ω–∞"
                                     action="#{deleteCreatureBean.cancelDeletion}"
                                     styleClass="btn btn-secondary"/>
                </div>
            </div>
        </div>
    </h:form>
</h:body>
</html>